# æ­¤å·¥ä½œæµä¼šå¯¹é•¿æ—¶é—´æ— æ´»åŠ¨çš„issueå’ŒPRå‘å‡ºè­¦å‘Šå¹¶å…³é—­
#
# æ‚¨å¯ä»¥é€šè¿‡ä¿®æ”¹æ­¤æ–‡ä»¶æ¥è°ƒæ•´è¡Œä¸º
# æ›´å¤šä¿¡æ¯è¯·å‚è€ƒ: https://github.com/actions/stale
name: æ ‡è®°è¿‡æœŸçš„issueå’Œpull request

on:
  schedule:
  - cron: '44 0 * * *'  # æ¯å¤©UTCæ—¶é—´0:44è¿è¡Œ
  workflow_dispatch:  # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  stale:
    runs-on: ubuntu-latest  # åœ¨æœ€æ–°ç‰ˆUbuntuä¸Šè¿è¡Œ
    permissions:
      issues: write  # å†™å…¥issueæƒé™
      pull-requests: write  # å†™å…¥PRæƒé™

    steps:
    - uses: actions/stale@v9  # ä½¿ç”¨staleåŠ¨ä½œv9ç‰ˆæœ¬
      with:
        repo-token: ${{ secrets.TOKEN }}  # ä½¿ç”¨ä»“åº“tokenè¿›è¡Œè®¤è¯

        # ========== Issue é…ç½® ==========
        stale-issue-message: |
          ğŸ‘‹ è¯¥issueå·²ç» **60å¤©** æ²¡æœ‰ä»»ä½•æ´»åŠ¨äº†ã€‚

          ä¸ºäº†ä¿æŒä»“åº“çš„æ•´æ´ï¼Œæˆ‘ä»¬ä¼šåœ¨ **14å¤©** åè‡ªåŠ¨å…³é—­æ­¤issueã€‚

          å¦‚æœæ‚¨è®¤ä¸ºæ­¤issueä»ç„¶éœ€è¦å…³æ³¨ï¼Œè¯·ï¼š
          - å›å¤æ­¤è¯„è®ºä»¥é‡ç½®è®¡æ—¶å™¨
          - æä¾›æ›´å¤šä¸Šä¸‹æ–‡ä¿¡æ¯
          - ç¡®è®¤æ˜¯å¦ä»åœ¨ç­‰å¾…è§£å†³

          æ„Ÿè°¢æ‚¨çš„è´¡çŒ®ï¼ğŸ™

        close-issue-message: |
          ğŸ”’ æ­¤issueç”±äºé•¿æ—¶é—´æ— æ´»åŠ¨ï¼ˆè¶…è¿‡74å¤©ï¼‰å·²è¢«è‡ªåŠ¨å…³é—­ã€‚

          å¦‚æœæ‚¨è®¤ä¸ºæ­¤issueä»ç„¶éœ€è¦è§£å†³ï¼Œè¯·ï¼š
          1. é‡æ–°æ‰“å¼€æ­¤issue
          2. æä¾›æœ€æ–°çš„çŠ¶æ€æ›´æ–°æˆ–è¡¥å……ä¿¡æ¯
          3. å¼•ç”¨ç›¸å…³å›¢é˜Ÿæˆå‘˜è¿›è¡Œå®¡æŸ¥

        days-before-issue-stale: 60  # issueå¤šä¹…æ— æ´»åŠ¨åæ ‡è®°ä¸ºè¿‡æœŸ
        days-before-issue-close: 14  # æ ‡è®°ä¸ºè¿‡æœŸåå¤šä¹…å…³é—­issue

        stale-issue-label: 'stale'  # æ ‡è®°è¿‡æœŸissueçš„æ ‡ç­¾
        close-issue-label: 'closed-due-to-inactivity'  # å…³é—­è¿‡æœŸissueæ—¶æ·»åŠ çš„æ ‡ç­¾
        close-issue-reason: 'not_planned'  # å…³é—­issueçš„åŸå› 

        # ========== Pull Request é…ç½® ==========
        stale-pr-message: |
          ğŸ‘‹ è¯¥PRå·²ç» **30å¤©** æ²¡æœ‰ä»»ä½•æ´»åŠ¨äº†ã€‚

          ä¸ºäº†ä¿æŒä»“åº“çš„æ•´æ´ï¼Œæˆ‘ä»¬ä¼šåœ¨ **14å¤©** åè‡ªåŠ¨å…³é—­æ­¤PRã€‚

          å¦‚æœæ‚¨è®¤ä¸ºæ­¤PRä»ç„¶éœ€è¦å…³æ³¨ï¼Œè¯·ï¼š
          - å›å¤æ­¤è¯„è®ºä»¥é‡ç½®è®¡æ—¶å™¨
          - è§£å†³æ‰€æœ‰CIæ£€æŸ¥å¤±è´¥
          - æ›´æ–°ä»£ç ä»¥è§£å†³å®¡æŸ¥æ„è§
          - è¯·æ±‚æœ€æ–°çš„ä»£ç å®¡æŸ¥

        close-pr-message: |
          ğŸ”’ æ­¤PRç”±äºé•¿æ—¶é—´æ— æ´»åŠ¨ï¼ˆè¶…è¿‡44å¤©ï¼‰å·²è¢«è‡ªåŠ¨å…³é—­ã€‚

          å¦‚æœæ‚¨è®¤ä¸ºæ­¤PRä»ç„¶éœ€è¦åˆå¹¶ï¼Œè¯·ï¼š
          1. é‡æ–°æ‰“å¼€æ­¤PR
          2. æ›´æ–°ä»£ç ä»¥è§£å†³è¿‡æ—¶çš„å†²çª
          3. ç¡®ä¿æ‰€æœ‰CIæ£€æŸ¥é€šè¿‡
          4. è¯·æ±‚æœ€æ–°çš„ä»£ç å®¡æŸ¥

        days-before-pr-stale: 30  # PRå¤šä¹…æ— æ´»åŠ¨åæ ‡è®°ä¸ºè¿‡æœŸ
        days-before-pr-close: 14  # æ ‡è®°ä¸ºè¿‡æœŸåå¤šä¹…å…³é—­PR

        stale-pr-label: 'stale'  # æ ‡è®°è¿‡æœŸPRçš„æ ‡ç­¾
        close-pr-label: 'closed-due-to-inactivity'  # å…³é—­è¿‡æœŸPRæ—¶æ·»åŠ çš„æ ‡ç­¾

        # ========== æ’é™¤é…ç½® ==========
        # æ’é™¤å¸¦æœ‰ä»¥ä¸‹æ ‡ç­¾çš„issueå’ŒPRï¼Œä¸ä¼šå¯¹å…¶è¿›è¡Œè¿‡æœŸå¤„ç†
        exempt-issue-labels: 'pinned,security,bug,enhancement,documentation'
        exempt-pr-labels: 'work-in-progress,wip,draft,security,bug,enhancement'

        # æ’é™¤ä»¥ä¸‹é‡Œç¨‹ç¢‘çš„issueå’ŒPR
        exempt-milestones: 'v1.0.0,stable'

        # æ’é™¤è‰ç¨¿PR
        exempt-draft-pr: 'true'

        # æ’é™¤æ‰€æœ‰æœ‰æŒ‡æ´¾äººçš„issue/PR
        exempt-all-assignees: 'false'

        # ========== æ ‡ç­¾ç®¡ç† ==========
        # å½“issue/PRæ¢å¤æ´»è·ƒæ—¶æ·»åŠ çš„æ ‡ç­¾
        labels-to-add-when-unstale: 'needs-attention'

        # å½“issue/PRæ ‡è®°ä¸ºè¿‡æœŸæ—¶ç§»é™¤çš„æ ‡ç­¾
        labels-to-remove-when-stale: 'help wanted,good first issue'

        # å½“issue/PRæ¢å¤æ´»è·ƒæ—¶ç§»é™¤çš„æ ‡ç­¾
        labels-to-remove-when-unstale: 'stale'

        # ========== å…¶ä»–é…ç½® ==========
        # æ¯æ¬¡è¿è¡Œæœ€å¤šå¤„ç†å¤šå°‘ä¸ªè¿‡æœŸissue/PR
        operations-per-run: 30

        # æ˜¯å¦åœ¨issue/PRè¢«æ›´æ–°æˆ–è¯„è®ºæ—¶ç§»é™¤è¿‡æœŸæ ‡ç­¾
        remove-stale-when-updated: 'true'

        # æ˜¯å¦åœ¨issue/PRè¢«å…³é—­æ—¶åˆ é™¤åˆ†æ”¯
        delete-branch: 'false'

        # æ˜¯å¦å¯ç”¨ç»Ÿè®¡ä¿¡æ¯
        enable-statistics: 'true'

        # æ˜¯å¦æŒ‰å‡åºå¤„ç†ï¼ˆä»æœ€æ—§çš„å¼€å§‹ï¼‰
        ascending: 'false'

        # æ˜¯å¦å¿½ç•¥æ›´æ–°ï¼ˆä»»ä½•æ›´æ–°éƒ½ä¼šé‡ç½®è¿‡æœŸæ—¶é—´ï¼‰
        ignore-updates: 'false'

        # æ˜¯å¦åªå¤„ç†æœ‰æŒ‡æ´¾äººçš„issue/PR
        include-only-assigned: 'false'